<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Address Book</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      @media (max-width: 640px) {
        .btn-group {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 10px;
          width: 100%;
        }

        /* Search & Find */
        .search-group {
          width: 100%;
          display: flex;
          flex-direction: column;
          gap: 10px;
        }

        .search-group input,
        .search-group button {
          width: 100%;
        }
      }
    </style>
  </head>

  <body
    class="p-4 sm:p-6 bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50 min-h-screen"
  >
    <header class="mb-6">
      <h1 class="text-3xl font-bold text-purple-700 drop-shadow-sm">
        Contacts
      </h1>
    </header>

    <div class="flex flex-wrap justify-between items-center mb-4 gap-3">
      <div class="btn-group flex flex-wrap gap-2 w-full sm:w-auto">
        <button
          id="btnNew"
          class="w-full sm:w-auto px-4 py-2 rounded-lg bg-gradient-to-r from-blue-300 to-blue-400 hover:from-blue-400 hover:to-blue-500 text-white shadow-md transition"
        >
          ‚ûï New
        </button>

        <button
          id="btnEdit"
          class="w-full sm:w-auto px-4 py-2 rounded-lg bg-gradient-to-r from-purple-300 to-purple-400 hover:from-purple-400 hover:to-purple-500 text-white shadow-md transition opacity-50 cursor-not-allowed"
          disabled
        >
          ‚úè Edit
        </button>

        <button
          id="btnDelete"
          class="w-full sm:w-auto px-4 py-2 rounded-lg bg-gradient-to-r from-pink-300 to-pink-400 hover:from-pink-400 hover:to-pink-500 text-white shadow-md transition opacity-50 cursor-not-allowed"
          disabled
        >
          üóë Delete
        </button>

        <button
          id="btnTrash"
          class="px-4 py-2 rounded-lg bg-gradient-to-r from-gray-300 to-gray-400 hover:from-gray-400 hover:to-gray-500 text-white shadow-md transition"
        >
          ‚ôªÔ∏è Trash
        </button>
      </div>

      <!-- SEARCH GROUP -->
      <div
        class="search-group flex flex-wrap items-center gap-2 w-full sm:w-auto"
      >
        <input
          id="searchInput"
          type="text"
          placeholder="Search..."
          class="w-full sm:w-auto border border-purple-200 px-4 py-2 rounded-full focus:ring-2 focus:ring-purple-300 shadow-sm"
        />
        <button
          id="btnSearch"
          class="w-full sm:w-auto px-4 py-2 rounded-lg bg-gradient-to-r from-purple-300 to-purple-400 hover:from-purple-400 hover:to-purple-500 text-white shadow-md transition"
        >
          üîç Find
        </button>
      </div>
    </div>

    <!-- TABLE -->
    <div
      class="overflow-x-auto shadow-lg rounded-xl bg-white/70 backdrop-blur-md border border-purple-100"
    >
      <table
        class="min-w-full border border-purple-100 rounded-xl text-sm sm:text-base"
        id="contactTable"
      >
        <thead class="bg-purple-100 text-purple-700">
          <tr class="border-b border-purple-200">
            <th class="p-3 text-left">
              <input id="checkAll" type="checkbox" />
            </th>
            <th class="p-3 text-left">Name</th>
            <th class="p-3 text-left">Phone</th>
            <th class="p-3 text-left">Email</th>
            <th class="p-3 text-left">Location</th>
          </tr>
        </thead>

        <tbody id="tableBody">
          <tr>
            <td colspan="5" class="p-4 text-center text-purple-500 italic">
              No contacts available
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- MODAL -->
    <div
      id="modal"
      class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4"
    >
      <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-md">
        <h2 id="modalTitle" class="text-xl font-semibold text-purple-700 mb-4">
          Add Contact
        </h2>

        <div class="space-y-3">
          <input
            id="modalName"
            type="text"
            placeholder="Name"
            class="w-full border px-3 py-2 rounded-md"
          />
          <input
            id="modalPhone"
            type="text"
            placeholder="Phone"
            class="w-full border px-3 py-2 rounded-md"
          />
          <input
            id="modalEmail"
            type="email"
            placeholder="Email"
            class="w-full border px-3 py-2 rounded-md"
          />
          <input
            id="modalLocation"
            type="text"
            placeholder="Location"
            class="w-full border px-3 py-2 rounded-md"
          />
        </div>

        <div class="flex justify-end gap-2 mt-5">
          <button
            id="modalCancel"
            class="px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300"
          >
            Cancel
          </button>
          <button
            id="modalSave"
            class="px-4 py-2 rounded-md bg-purple-500 text-white hover:bg-purple-600"
          >
            Save
          </button>
        </div>
      </div>
    </div>

    <script>
      let contacts = [];
      let selectedId = null;

      const tableBody = document.getElementById("tableBody");
      const btnEdit = document.getElementById("btnEdit");
      const btnDelete = document.getElementById("btnDelete");

      function renderTable() {
        tableBody.innerHTML = "";

        if (contacts.length === 0) {
          tableBody.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-purple-500 italic">No contacts available</td></tr>`;
          return;
        }

        contacts.forEach((c) => {
          const row = document.createElement("tr");
          row.classList.add("hover:bg-purple-50", "transition");

          row.innerHTML = `
            <td class="p-3"><input type="checkbox" class="rowCheck" data-id="${c.id}"></td>
            <td class="p-3">${c.name}</td>
            <td class="p-3">${c.phone}</td>
            <td class="p-3">${c.email}</td>
            <td class="p-3">${c.location}</td>
          `;

          tableBody.appendChild(row);
        });

        refreshButtons();
      }

      function refreshButtons() {
        const checked = document.querySelectorAll(".rowCheck:checked").length;

        if (checked === 1) {
          btnEdit.disabled = false;
          btnEdit.classList.remove("opacity-50", "cursor-not-allowed");
        } else {
          btnEdit.disabled = true;
          btnEdit.classList.add("opacity-50", "cursor-not-allowed");
        }

        if (checked > 0) {
          btnDelete.disabled = false;
          btnDelete.classList.remove("opacity-50", "cursor-not-allowed");
        } else {
          btnDelete.disabled = true;
          btnDelete.classList.add("opacity-50", "cursor-not-allowed");
        }
      }

      document.addEventListener("change", refreshButtons);

      // Modal
      const modal = document.getElementById("modal");
      const modalTitle = document.getElementById("modalTitle");
      const modalName = document.getElementById("modalName");
      const modalPhone = document.getElementById("modalPhone");
      const modalEmail = document.getElementById("modalEmail");
      const modalLocation = document.getElementById("modalLocation");

      function openModal(edit = false) {
        modal.classList.remove("hidden");
        modalTitle.textContent = edit ? "Edit Contact" : "Add Contact";

        if (edit) {
          const id = document.querySelector(".rowCheck:checked").dataset.id;
          selectedId = id;
          const c = contacts.find((x) => x.id == id);

          modalName.value = c.name;
          modalPhone.value = c.phone;
          modalEmail.value = c.email;
          modalLocation.value = c.location;
        } else {
          modalName.value = "";
          modalPhone.value = "";
          modalEmail.value = "";
          modalLocation.value = "";
        }
      }

      function closeModal() {
        modal.classList.add("hidden");
      }

      document.getElementById("btnNew").onclick = () => openModal(false);
      document.getElementById("btnEdit").onclick = () => openModal(true);
      document.getElementById("modalCancel").onclick = closeModal;

      document.getElementById("modalSave").onclick = () => {
        const data = {
          name: modalName.value,
          phone: modalPhone.value,
          email: modalEmail.value,
          location: modalLocation.value,
        };

        if (selectedId) {
          const idx = contacts.findIndex((x) => x.id == selectedId);
          contacts[idx] = { id: selectedId, ...data };
          selectedId = null;
        } else {
          contacts.push({ id: Date.now(), ...data });
        }

        closeModal();
        renderTable();
      };

      // Delete
      document.getElementById("btnDelete").onclick = () => {
        const checked = [...document.querySelectorAll(".rowCheck:checked")].map(
          (c) => c.dataset.id
        );
        contacts = contacts.filter((c) => !checked.includes(c.id.toString()));
        renderTable();
      };

      // Search
      document.getElementById("btnSearch").onclick = () => {
        const keyword = document
          .getElementById("searchInput")
          .value.toLowerCase();

        const filtered = contacts.filter(
          (c) =>
            c.name.toLowerCase().includes(keyword) ||
            c.phone.includes(keyword) ||
            c.email.toLowerCase().includes(keyword) ||
            c.location.toLowerCase().includes(keyword)
        );

        tableBody.innerHTML = "";

        if (filtered.length === 0) {
          tableBody.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-purple-500 italic">No matching results</td></tr>`;
          return;
        }

        filtered.forEach((c) => {
          const row = document.createElement("tr");
          row.classList.add("hover:bg-purple-50", "transition");

          row.innerHTML = `
            <td class="p-3"><input type="checkbox" class="rowCheck" data-id="${c.id}"></td>
            <td class="p-3">${c.name}</td>
            <td class="p-3">${c.phone}</td>
            <td class="p-3">${c.email}</td>
            <td class="p-3">${c.location}</td>
          `;

          tableBody.appendChild(row);
        });
      };
    </script>
  </body>
</html>
